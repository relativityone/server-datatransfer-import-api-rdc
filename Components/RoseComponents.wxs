<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:fw="http://schemas.microsoft.com/wix/FirewallExtension">
  <?include $(sys.CURRENTDIR)\Variables.wxi ?>
	<Fragment>
	  <ComponentGroup Id="RoseComponents" Directory="ROSE_INSTALLDIR">
	    <ComponentGroupRef Id="RoseAutoGeneratedComponentGroup"/>
      <Component Id="StagingExplorer" Guid="{BC3FC5EE-B4B3-4A88-A7CA-1297D2C3DB52}" KeyPath="yes">
        <File Id='Relativity.StagingExplorer' Name='Relativity.StagingExplorer.exe' Source='$(var.kCura.WinEDDS.StagingExplorer.Setup.TargetDir)\Relativity.StagingExplorer.exe' />
      </Component>
      <Component Id='Relativity.StagingExplorer.Config' Guid='{F8FA98CA-4E86-4930-91ED-F481B5C7F564}' KeyPath='yes'>
        <File Id='Relativity.StagingExplorer.Config' Name='Relativity.StagingExplorer.exe.config' Source='$(var.kCura.WinEDDS.StagingExplorer.Setup.TargetDir)\Relativity.StagingExplorer.exe.config' />
      </Component>
	    <Component Id="ROSEFirewall" Guid="{22F5B99D-7066-4145-B341-3F9529A7B041}" KeyPath="yes">
	      <Condition>SETFIREWALL</Condition>
	      <!--Adding firewall exceptions to support Aspera. -->
	      <fw:FirewallException
	        Id="RoseClientTCPInbound"
	        File="Relativity.StagingExplorer"
	        Protocol="tcp"
	        Name="Relativity Staging Explorer TCP"
	        Port="*"
	        Scope="any"
	        IgnoreFailure="no"
	        Profile="all"/>
	      <fw:FirewallException
	        Id="RoseClientUDPInbound"
	        File="Relativity.StagingExplorer"
	        Protocol="udp"
	        Name="Relativity Staging Explorer UDP"
	        Port="*"
	        Scope="any"
	        IgnoreFailure="no"
	        Profile="all"/>
	    </Component>
    </ComponentGroup>
  </Fragment>
</Wix>