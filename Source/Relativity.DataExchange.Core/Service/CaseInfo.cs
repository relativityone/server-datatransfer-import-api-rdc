//------------------------------------------------------------------------------
// <auto-generated>
// </auto-generated>
//------------------------------------------------------------------------------

namespace Relativity.DataExchange.Service
{
	using System;

	/// <summary>
	/// Represents a Relativity case or workspace information data object. This class cannot be inherited, backwards compatibility isn't guaranteed, and should never be consumed by API users.
	/// </summary>
	/// <remarks>
	/// There's too much risk and too many expectation to make this type internal.
	/// </remarks>
	[Serializable]
	public sealed class CaseInfo
	{
		private string documentPath;
		private string downloadHandlerURL;

		/// <summary>
		/// Initializes a new instance of the <see cref="CaseInfo"/> class.
		/// </summary>
		public CaseInfo()
		{
		}

		/// <summary>
		/// Initializes a new instance of the <see cref="CaseInfo"/> class.
		/// </summary>
		/// <param name="row">
		/// The data row.
		/// </param>
		public CaseInfo(System.Data.DataRow row)
		{
			if (row == null)
			{
				throw new ArgumentNullException(nameof(row));
			}

			// Note: AsImportAllowed/ExportAllowed are NOT mapped.
			this.ArtifactID = System.Convert.ToInt32(row["ArtifactID"]);
			this.DocumentPath = System.Convert.ToString(row["DefaultFileLocationName"]);
			this.DownloadHandlerURL = System.Convert.ToString(row["DownloadHandlerApplicationPath"]);
			this.EnableDataGrid = System.Convert.ToBoolean(row["EnableDataGrid"]);
			this.MatterArtifactID = System.Convert.ToInt32(row["MatterArtifactID"]);
			this.Name = System.Convert.ToString(row["Name"]);
			this.RootArtifactID = System.Convert.ToInt32(row["RootArtifactID"]);
			this.RootFolderID = System.Convert.ToInt32(row["RootFolderID"]);
			this.StatusCodeArtifactID = System.Convert.ToInt32(row["StatusCodeArtifactID"]);
		}

		public int ArtifactID { get; set; }

		public bool AsImportAllowed { get; set; }

		public string DocumentPath
		{
			get
			{
				return this.documentPath;
			}

			set
			{
				this.documentPath = AppendTrailingSlash(value, '\\');
			}
		}

		public string DownloadHandlerURL
		{
			get
			{
				return this.downloadHandlerURL;
			}

			set
			{
				this.downloadHandlerURL = AppendTrailingSlash(value, '/');
			}
		}

		public bool EnableDataGrid { get; set; }

		public bool ExportAllowed { get; set; }

		public int MatterArtifactID { get; set; }

		public string Name { get; set; }

		public int RootArtifactID { get; set; }

		public int RootFolderID { get; set; }

		public int StatusCodeArtifactID { get; set; }

		private static string AppendTrailingSlash(string value, char slash)
		{
			if (value != null &&
			    value.LastIndexOf(slash) != value.Length - 1)
			{
				value += slash;
			}

			return value;
		}
	}
}