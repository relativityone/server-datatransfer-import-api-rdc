<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
		 xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
  <?include $(sys.CURRENTDIR)\Variables.wxi ?>
  <Fragment>
    <!-- Note: Heat was used to auto-generate the payload parameters                                                      -->
    <!--       e.g. heat.exe payload {filename} -o payload.wxs                                                            -->
    <util:RegistrySearch
			Root="HKLM"
			Key="SOFTWARE\Microsoft\Net Framework Setup\NDP\v4\Full"
			Value="Version"
			Variable="Netfx4FullVersion" />
    <util:RegistrySearch
			Root="HKLM"
			Key="SOFTWARE\Microsoft\Net Framework Setup\NDP\v4\Full"
			Value="Version"
			Variable="Netfx4x64FullVersion"
			Win64="yes" />

    <!-- windows 7 SP1, windows 8.1, win 10, Windows Server 2012 R2 and later
				https://msdn.microsoft.com/library/aa370556.aspx
		-->
    <PackageGroup Id="DotNetPrereq">
      <ExePackage Id="Netfx4Full" Cache="yes" Compressed="no" PerMachine="yes"
									Permanent="yes"
									Vital="yes"
									DisplayName="Microsoft .NET Framework 4.6.2"
									InstallCommand="/q /norestart /ChainingPackage $(var.ProductName)"
									Name="NDP462-KB3151800-x86-x64-AllOS-ENU.exe"
									DownloadUrl="https://download.microsoft.com/download/F/9/4/F942F07D-F26F-4F30-B4E3-EBD54FABA377/NDP462-KB3151800-x86-x64-AllOS-ENU.exe"
									InstallCondition="(((VersionNT = v6.1 OR VersionNT64 = v6.1) AND ServicePackLevel = 1) OR VersionNT &gt; v6.2 OR VersionNT64  &gt; v6.2) AND (NOT Netfx4FullVersion OR Netfx4FullVersion &lt; v4.6.2)"
									DetectCondition="(((VersionNT = v6.1 OR VersionNT64 = v6.1)  AND ServicePackLevel = 1) OR VersionNT &gt; v6.2 OR VersionNT64 &gt; v6.2) AND Netfx4FullVersion AND Netfx4FullVersion &gt;= v4.6.2">
        <ExitCode Value="0" Behavior="success" />
        <ExitCode Value="1641" Behavior="forceReboot"/>
        <ExitCode Value="3010" Behavior="forceReboot"/>
        <ExitCode Behavior="error"/>
        <RemotePayload CertificatePublicKey="52868DFCA6E3AF2632389E6C1EE7D0468D3797D0"
                       CertificateThumbprint="3BDA323E552DB1FDE5F4FBEE75D6D5B2B187EEDC"
                       Description="Microsoft .NET Framework 4.6.2 Setup"
                       Hash="A70F856BDA33D45AD0A8AD035F73092441715431"
                       ProductName="Microsoft .NET Framework 4.6.2"
                       Size="62008080"
                       Version="4.6.1590.0" />
      </ExePackage>
    </PackageGroup>
  </Fragment>
</Wix>